# Pacemaker Dashboard 🫀

**基于 Web 的心脏起搏器程控随访数据可视化管理系统**

> ⚠️ **当前状态**：项目处于 **Phase 1 (后端数据清洗与结构化)** 阶段。核心关注点是从异构的 Excel 报告中精准提取临床数据。由于涉及患者隐私，**本仓库仅包含核心代码逻辑，不包含任何临床原始数据。**

## 🎯 项目愿景

在心电诊断科程控随访工作中，医生面临大量不同品牌（美敦力、雅培、波科等）和不同格式的程控报告。本项目旨在构建一个**统一的前端可视化面板**，将这些杂乱的非结构化数据转化为直观、标准化的视图，辅助医生进行：

1.  **快速查阅**：一目了然地查看关键参数（阈值、阻抗、电池寿命）。
2.  **趋势分析**：追踪患者长期的参数变化（如电极阻抗趋势）。
3.  **异常预警**：自动高亮显示超出正常范围的指标。

## 🛠️ 当前进度 (Phase 1: Backend ETL)

目前已完成核心的 **ETL (Extract, Transform, Load)** 管道，能够从原始 Excel 报告中清洗出标准化的 JSON 数据。

-   **多厂家支持**：适配美敦力、雅培、波科、百多力、创领等主流品牌。
-   **模板自适应**：自动识别 14+ 种不同的报告模板（起搏器/ICD/CRT-D/CRT-P）。
-   **智能提取**：
    -   ✔️ **基础参数**：模式、频率、AV间期等。
    -   ✔️ **测试数据**：精准提取心房/心室的阈值、阻抗、感知数据。
    -   ✔️ **事件记录**：房颤(AF)、室速(VT/VF)等事件的负荷与次数。
    -   ✔️ **电池状态**：电压、阻抗及预估剩余寿命 (ERI/EOS)。
-   **增量处理**：MD5 校验机制，仅处理新导入或修改的报告文件。

## 💡 核心资产：数据中心 (Data Hub)

ETL 管道的最终产物 `backend/output/pacemaker_data.json` 是本项目的核心资产。它不仅仅是一个输出文件，更是连接后端数据清洗与前端可视化应用的关键桥梁。

### `pacemaker_data.json` 的应用潜力：

1.  **Web Dashboard 的“单一信源”**：
    -   前端应用（Web App）将直接读取此 JSON 文件进行渲染。这意味着前端开发完全**与后端解耦**，无需关心复杂的 Excel 解析逻辑，只需专注于数据展示和交互体验。
    
2.  **临床科研的“金矿”**：
    -   该文件将散落在数千份 Excel 中的非结构化数据变成了**可查询的结构化数据库**。
    -   **应用场景**：
        -   *“筛选所有右室阈值 > 2.0V 的患者”*
        -   *“统计过去一年美敦力起搏器的房颤(AF)发生负荷分布”*
        -   直接转换为 Pandas DataFrame，进行生存分析或相关性研究。

3.  **AI 辅助系统的上下文 (Context)**：
    -   清洗后的 JSON 移除了 Excel 中的格式噪音，仅保留高价值信息，极大地降低了 Token 消耗。
    -   它可以作为 **RAG (检索增强生成)** 系统的知识库，让 LLM (如 Gemini/GPT) 能够回答复杂的临床问题，甚至自动生成患者随访总结。

## 🗺️ 未来规划 (Roadmap)

以下是项目未来的演进方向：

### Phase 2: 可视化面板 (Dashboard MVP)
-   [ ] **Web 前端搭建**：使用现代前端框架 (React/Vue/Next.js) 构建用户界面。
-   [ ] **单页详情视图**：还原并美化纸质报告，以更符合临床习惯的方式展示单次程控数据。
-   [ ] **关键指标卡片**：顶部高亮展示“电量”、“起搏比例”、“最近事件”等核心关注点。

### Phase 3: 患者纵向管理 (Longitudinal View)
-   [ ] **患者时间轴**：将同一患者的历史程控记录串联，形成时间轴。
-   [ ] **趋势图表**：绘制阈值、阻抗、P/R波幅度的历史变化曲线，辅助判断导线稳定性。
-   [ ] **电池耗竭预测**：基于历史电压下降斜率，更精准地预测更换时间。

### Phase 4: 统计与科研 (Analytics)
-   [ ] **科室概览**：统计科室管理的起搏器品牌分布、植入量统计。
-   [ ] **异常筛选**：一键筛选出所有“心房阻抗异常”或“发生过AF”的患者列表。
-   [ ] **科研导出**：支持将清洗后的数据批量导出为 CSV/Excel，直接用于 SPSS/R 统计分析。

### Phase 5: AI 辅助 (Intelligence)
-   [ ] **报告自动解读**：基于 LLM 生成通俗易懂的随访小结。
-   [ ] **风险预警**：识别潜在的参数设置冲突或非生理性数据。

## 🏗️ 项目结构

```
Pacemarker_Dashboard/
├── backend/                # 核心数据处理引擎
│   ├── core/               # 提取逻辑与解析器
│   ├── data/               # 模板定义 (JSON)
│   ├── scripts/            # 批处理脚本
│   └── output/             # 清洗后的结构化数据 (JSON) - [Git Ignored]
├── 01_data_repository/     # 原始 Excel 报告存放区 - [Git Ignored 🔒]
└── doc/                    # 开发文档
```

## � 隐私与安全

本项目严格遵循数据隐私原则：
1.  **代码与数据分离**：所有临床原始数据（`01_data_repository/`）和提取结果（`backend/output/`）均已通过 `.gitignore` 排除，**绝不会**上传至 GitHub。
2.  **本地化运行**：设计为本地部署工具，数据处理全流程主要在内网或本地电脑完成。

## 🚀 使用指南

### 1. 环境准备
```bash
pip install openpyxl xlrd pandas
```

### 2. 数据准备
将医院导出的 Excel 格式程控报告放入 `01_data_repository` 文件夹（支持子文件夹结构）。

### 3. 运行清洗
```bash
# 执行全量提取，生成 JSON 数据
python backend/main.py
```

---
*Developed with ❤️ for Electrophysiology.*
